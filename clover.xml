<?xml version="1.0"?>
<project name="clover">

  <taskdef resource="cloverlib.xml" classpath="${clover.jar}"/>

  <target name="with.clover">
    <clover-setup initstring="${build}/instrument/coverage.db">
      <files>
        <!-- temporary: this is placeholder code -->
        <exclude name="**/OSGiServiceRegistry.java"/>
        <exclude name="**/*Exception.java"/>
      </files>
      <methodContext name="toString" regexp="(.* )?public String toString\(\).*"/>
      <methodContext name="privateCtor" regexp="(.* )?private \w+\(\).*"/>
      <statementContext name="resolve" regexp="^if \(resolve\) \{.*"/>
      <testsources dir="${test}">
        <testclass annotation="Test"/>
      </testsources>
    </clover-setup>
  </target>

  <target name="clover.report">
    <clover-report>
      <current outfile="${doc}/coverage" title="peaberry">
        <format type="html" filter="toString,privateCtor,resolve"/>
        <testsources dir="${test}"/>
      </current>
    </clover-report>
  </target>

</project>
